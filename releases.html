<html>
<head>
  <title>ZSH - Release Notes</title>
  <link rel="icon" href="favicon.png" type="image/png">
  <link rel="up" href="./">
  <link rel="top" href="./">
  <link rel="prev" href="about.html">
  <link rel="next" href="links.html">
  <link rel="first" href="News/">
  <link rel="last" href="links.html">
  <link rev="made" href="mailto:zsh-workers@zsh.org">
</head>

<body bgcolor="#ffffff" text="#000000">

<table width="100%">
<tr><td>
<a href="about.html"><img src="Images/prev.png" alt="[prev]" width=30 height=30></a>
<a href="links.html"><img src="Images/next.png" alt="[next]" width=30 height=30></a>
<a href="./"><img src="Images/up.png" alt="[up]" width=30 height=30></a>
<a href="./"><img src="Images/top.png" alt="[top]" width=30 height=30></a>
</td>
<td>
<font size="+3" align=center><strong>Release Notes</strong></font>
</td>
</tr>
</table>
<hr size=1 noshade>

<h2>Changes between versions 5.3 and 5.3.1</h2>

<ul>
<li>
    Fix handling of "printf -" and "printf --".
</li>

<li>
    Minor completion fixes for FreeBSD (sysctl, chflags).
</li>
</ul>


<h2>Changes between versions 5.2 and 5.3</h2>

<h3>Incompatibilities</h3>

<ul>
<li>
In character classes delimited by "[" and "]" within patterns, whether
used for filename generation (globbing) or other forms of pattern
matching, it used not to be possible to quote "-" when used for a range,
or "^" and "!" when used for negating a character set.  The characters can
now be quoted by any of the standard shell means, but note that
the "[" and "]" must not be quoted.  For example,

<pre>
  [[ $a = ['a-z'] ]]
</pre>

matches if the variable a contains just one of the characters "a", "-"
or "z" only.  Previously this would have matched any lower case ASCII
letter.  Note therefore the useful fact that

<pre>
  [[ $a = ["$cset"] ]]
</pre>

matches any character contained in the variable "cset".  A consequence
of this change is that variables that should have active ranges need
(with default zsh options) to be indicated explicitly, e.g.

<pre>
  cset="a-z"
  [[ b = [${~cset}] ]]
</pre>

The "~" causes the "-" character to be active.  In sh emulation the
"~" is unncessary in this example and double quotes must be used to
suppress the range behaviour of the "-".
</li>

<li>
The first argument to 'repeat' is now evaluated as an arithmetic
expression.  It was always documented to be an arithmetic expression, but
until now the decimal integer at the start of the value was used and the
remainder of the value discarded.  This could lead to different behaviour
if the argument contains non-numeric characters, or if the argument has
leading zeroes and the OCTAL_ZEROES option is set.
</li>

<li>
<p>
For some time the shell has had a POSIX_TRAPS option which determines
whether the EXIT trap has POSIX behaviour (the trap is only run at shell
exit) or traditional zsh behaviour (the trap is run once and discarded
when the enclosing fuction or shell exits, whichever happens first).
The use of this option has now been made "sticky" on the EXIT trap ---
in other words, the setting of the option at the point where the trap is
set now determines whether the trap has POSIX or traditional zsh
behaviour.  This means that changing the option after the trap was set
no longer has any effect.
</p>

<p>
Other aspects of EXIT trap handling have not changed --- there is still
only one EXIT trap at any point in a programme, so it is not generally
useful to combine POSIX and non-POSIX behaviour in the same script.
</p>
</li>

<li>
There was an undocumented feature dating from the early days of zsh
that glob qualifiers consisting only of the digits 0 to 7 were treated
as an octal file mode to "and" with the modes of files being tested.
This has been removed in order to be more sensitive to syntax errors.
The "f" qualifier has for many years been the documented way of testing
file modes; it allows the "and" test ("*(f+1)" is the documented
equivalent of "*(1)") as well as many other forms.
</li>

<li>
<p>
The completion helper function _arguments now escapes both backslashes
and colons in the values of option arguments when populating the $opt_args
associative array.  Previously, colons were escaped with a backslash but
backslashes were not themselves escaped with a backslash, which lead to
ambiguity: '-x foo\:bar' (one argument with a backslashed colon) and
'-x foo\\ bar' (two arguments, and the first one ends in a backslash) would
both set $opt_args[-x] to the same value.  This example assumes the -x
option's spec declared two arguments, as in:
</p>

<pre>
    _arguments : -x:foo:${action}:bar:$action
</pre>

<p>
For the more common case of non-repeatable options that take a single
argument, completion functions now have to unescape not only colons but
also backslashes when obtaining the option's argument from $opt_args.
</p>
</li>

<li>
Previously, if the function command_not_found_handler was run
in place of a command-not-found error, and the function returned
non-zero status, zsh set the status to 127 and printed an error message
anyway.  Now, the status from the handler is retained and no additional
message is printed.  The main reasons for this change are that it was not
possible to return a non-zero status to the parent shell from a command
executed as a replacement, and the new implementation is more consistent
with other shells.
</li>

<li>
The output of "typeset -p" (and synonyms) now takes into account the
function scope and export state of each parameter.  Exported parameters
are output as "export" commands unless the parameter is also local, and
other parameters not local to the scope are output with the "-g" option.
Previously, only "typeset" commands were output, never using "-g".
</li>

<li>
At spelling-correction prompt ($SPROMPT), where the choices offered are
[nyae], previously &lt;Enter&gt; would be accepted to mean [N] and &lt;Space&gt; and
&lt;Tab&gt; would be accepted to mean [Y].  Now &lt;Space&gt; and &lt;Tab&gt; are invalid
choices: typing either of them remains at the prompt.
</li>

<li>
The $ary[i,j] subscript syntax to take a slice of an array behaves
differently when both i and j are larger than the number of elements in
the array.  When i == j, such a slice always yields an empty array, and
when i &lt; j it always yields an array of one empty string element.  The
following example illustrates how this differs from past versions.

<pre>
     nargs() { print $# }
     a=(one two)
     for i in 1 2 3 4; do
      for j in 1 2 3 4 5; do
       print -n "$i $j =&gt; "
       nargs "${(@)a[i,j]}"
      done
     done
     
     5.2       |  5.3 **
     ----------+----------
     1 1 =&gt; 1  |  1 1 =&gt; 1
     1 2 =&gt; 2  |  1 2 =&gt; 2
     1 3 =&gt; 2  |  1 3 =&gt; 2
     1 4 =&gt; 2  |  1 4 =&gt; 2
     1 5 =&gt; 2  |  1 5 =&gt; 2
     2 1 =&gt; 0  |  2 1 =&gt; 0
     2 2 =&gt; 1  |  2 2 =&gt; 1
     2 3 =&gt; 1  |  2 3 =&gt; 1
     2 4 =&gt; 1  |  2 4 =&gt; 1
     2 5 =&gt; 1  |  2 5 =&gt; 1
     3 1 =&gt; 0  |  3 1 =&gt; 0
     3 2 =&gt; 0  |  3 2 =&gt; 0
     3 3 =&gt; 0  |  3 3 =&gt; 0
     3 4 =&gt; 0  |  3 4 =&gt; 1   **
     3 5 =&gt; 0  |  3 5 =&gt; 1   **
     4 1 =&gt; 0  |  4 1 =&gt; 0
     4 2 =&gt; 0  |  4 2 =&gt; 0
     4 3 =&gt; 0  |  4 3 =&gt; 0
     4 4 =&gt; 1  |  4 4 =&gt; 0   **
     4 5 =&gt; 1  |  4 5 =&gt; 1
</pre>
</li>
</ul>

<h3>Changes</h3>

<ul>
<li>
It is possible to enable character width support for Unicode 9 by
configuring with `--enable-unicode9'; this compiles in some additional
tables.  At some point this support may move into a module, in which
case the configure option will be changed to cause the module to be
permanently loaded.  This option is not useful unless your terminal also
supports Unicode 9.
</li>

<li>
The new word modifier ':P' computes the physical path of the argument.
It is different from the existing ':a' modifier which always resolves
'/before/here/../after' to '/before/after', and differs from the
existing ':A' modifier which resolves symlinks only after 'here/..' is
removed, even when /before/here is itself a symbolic link.  It is
recommended to review uses of ':A' and, if appropriate, convert them
to ':P' as soon as compatibility with 5.2 is no longer a requirement.
</li>

<li>
The output of "typeset -p" uses "export" commands or the "-g" option
for parameters that are not local to the current scope.  Previously,
all output was in the form of "typeset" commands, never using "-g".
</li>

<li>
vi-repeat-change can repeat user-defined widgets if the widget calls
zle -f vichange.
</li>

<li>
The parameter $registers now makes the contents of vi register buffers
available to user-defined widgets.
</li>

<li>
New vi-up-case and vi-down-case builtin widgets bound to gU/gu (or U/u
in visual mode) for doing case conversion.
</li>

<li>
A new select-word-match function provides vim-style text objects with
configurable word boundaries using the existing match-words-by-style
mechanism.
</li>

<li>
Support for the conditional expression [[ -v var ]] to test if a
variable is set for compatibility with other shells.
</li>

<li>
The print and printf builtins have a new option -v to assign the output
to a variable. This is for bash compatibility but with the additional
feature that, for an array, a separate element is used each time the
format is reused.
</li>

<li>
New x: syntax in completion match specifications make it possible to
disable match specifications hardcoded in completion functions.
</li>
</ul>


<h2>Changes between versions 5.1.1 and 5.2</h2>

<h3>Incompatibilities</h3>

<p>
The behaviour of the parameter flag (P) has changed when it appears
in a nested parameter group, in order to make it more useful in
such cases.  A (P) in the outermost parameter group behaves as
before.
</p>

<h3>Changes</h3>

<ul>
<li>
The new module zsh/param/private can be loaded to allow the shell
to define parameters that are private to a function scope (i.e. are
not propagated to nested functions called within this function).
</li>

<li>
The parameter flag ${(P)...} is now more useful when it appears in
a nested expansion.  For example,

<pre>
  typeset -A assoc=(one un two deux three trois)
  name=assoc
  print ${${(P)name}[one]}
</pre>

now prints "un".  In previous versions of the shell the value of the
substitution was fully expanded on return from ${(P)name}, making
associative array subscripting difficult.  As a side effect, flags
for formatting appearing in the inner substitution now affect the
substitution of the name (into "assoc" in this case), which is not
normally useful: flags that should apply to the value must be in the
outer substitution.
</li>

<li>
The GLOB_STAR_SHORT option allows the pattern **/* to be shortened to
just ** if no / follows. so **.c searches recursively for a file whose
name has the suffix ".c".
</li>

<li>
The effect of the WARN_CREATE_GLOBAL option has been significantly
extended, so expect it to cause additional warning messages about
parameters created globally within function scope.
</li>
</ul>


<h2>Changes between versions 5.1 and 5.1.1</h2>

<ul>
<li>
The ZLE variables YANK_ACTIVE, YANK_START and YANK_END have been added and are
useful for managing highlighting.
</li>

<li>
The zsh-specific pattern match range tests have been supplemented with
[:INCOMPLETE:] and [:INVALID:] to help detect the state of partially
read multibyte character strings.
</li>
</ul>


<h2>Changes between versions 5.0.8 and 5.1</h2>

<p>
The builtins declare, export, local, readonly and typeset now have
corresponding reserved words.  When used in this form, the builtin syntax is
extended so that assignments following the reserved word are treated similarly
to assignments that appear at the start of the command line. For example,
<pre>
  local scalar=`echo one word` array=(several words)
</pre>
creates a local "scalar" containing the text "one word" and an array "array"
containing the words "several" "words".
</p>

<ul>
<li>
The print builtin has new options -x and -X to expand tabs.
</li>

<li>
Several new command completions and numerous updates to others.
</li>

<li>
Options to "fc" to segregate internal and shared history.
</li>

<li>
All emulations including "sh" use multibyte by default; several repairs to
multibyte handling.
</li>

<li>
ZLE supports "bracketed paste" mode to avoid interpreting pasted newlines as
accept-line.  Pastes can be highlighted for visibility and to make it more
obvious whether accept-line has occurred.
</li>

<li>
Improved (though still not perfect) POSIX compatibility for getopts builtin
when POSIX_BUILTINS is set.
</li>

<li>
New setopt APPEND_CREATE for POSIX-compatible NO_CLOBBER behavior.
</li>

<li>
Completion of date values now displays in a calendar format when the complist
module is available.  Controllable by zstyle.
</li>

<li>
New parameter UNDO_LIMIT_NO for more control over ZLE undo repeat.
</li>

<li>
Several repairs/improvements to the contributed narrow-to-region ZLE function.
</li>

<li>
Many changes to child-process and signal handling to eliminate race conditions
and avoid deadlocks on descriptor and memory management.
</li>

<li>
New builtin sysopen in zsh/system module for detailed control of file
descriptor modes.
</li>
</ul>

<h2>Changes between versions 5.0.7 and 5.0.8</h2>

<ul>
<li>
Global aliases can be created for syntactic tokens such as command separators
(";", "&amp;", "|", "&amp;&amp;", "||"), redirection operators, etc. Use at
your own risk! The POSIX_ALIASES option is interpreted more strictly to
prevent expansion of these and other alias names containing quotes, glob
metacharacters, parameter references, etc.
</li>

<li>
There have been various further improvements to builtin handling with the
POSIX_BUILTINS option (off by default) for compatibility with the POSIX
standard.
</li>

<li>
'whence -v' is now more informative, and 'whence -S' shows you how a full
chain of symbolic links resolves to a command.
</li>

<li>
The 'p' parameter flag now allows an argument to be specified as a reference
to a variable, e.g. ${(ps.$sep.)foo} to split $foo on a string given by $sep.
</li>

<li>
The option FORCE_FLOAT now forces variables, not just constants, to floating
point in arithmetic expressions.
</li>

<li>
The type of an assignment in arithmetic expressions, e.g. the type seen by the
variable res in $(( res = a = b )), is now more logical and C-like.
</li>

<li>
The default binding of 'u' in vi command mode has changed to undo multiple
changes when invoked repeatedly. '^R' is now bound to redo changes. To revert
to toggling of the last edit use:
<pre>
    bindkey -a u vi-undo-change
</pre>
</li>

<li>
Compatibility with Vim has been improved for vi editing mode. Most notably,
Vim style text objects are supported and the region can be manipulated with vi
commands in the same manner as Vim's visual mode.
</li>

<li>
Elements of the watch variable may now be patterns.
</li>

<li>
The logic for retrying history locking has been improved.
</li>

<li>
Some rationalisations have been made to the zsh/db/gdbm module that should
make it more useful and predictable in operation.
</li>
</ul>


<h2>Changes between versions 5.0.6 and 5.0.7</h2>

<ul>
<li>
Contains a security fix to disallow evaluation of the initial values of
integer variables imported from the environment (they are instead treated as
literal numbers).  That could allow local privilege escalation, under some
specific and atypical conditions where zsh is being invoked in privilege
elevation contexts when the environment has not been properly sanitized, such
as when zsh is invoked by sudo on systems where "env_reset" has been disabled.
</li>

<li>
The default $fpath/$FPATH is now designed always to include
/usr/local/share/zsh/site-functions.  This directory does not need to exist.
Sites that set an explicit site directory can put that in /etc/zshenv as
before.  The intention of the new path element is to increase the likelihood
that locally added functions can be found with the shell running "out of the
box", no matter how the shell was configured.
</li>

<li>
In prompt strings, %e or the equivalent test %(e..) are used to output or test
the execution / evaluation depth of a shell construct within functions etc.
This is useful in $PS4.
</li>

<li>
Redirections applied to function definitions take effect when the function is
executed, not when it is defined.  Other shells already work this way.  For
example, <code>fn() { echo hello } &gt;~/logfile</code> Running fn writes
"hello" to logfile.  In older versions of the shell it would create an empty
file at the point of definition.
</li>
</ul>


<h2>Changes between versions 5.0.5 and 5.0.6</h2>

<h3>Incompatibilities</h3>

<p>
The value of $? when a job becomes stopped is now the signal number plus 128,
for compatibility with other shells.  Note that different operating systems
use different values e.g. for SIGTSTP, so it is not possible in portable
scripts to detect stopped jobs by comparing to a fixed number. Also, the value
of $pipestatus is now updated when a job stops, not just when it exits.
</p>

<h3>Changes</h3>

<ul>
<li>
If the option EXTENDED_GLOB is in effect, it is possible to force globbing
within conditional code using the [[ ... ]] syntax by flagging that a certain
string is a glob using the (#q) glob qualifier syntax. The resulting glob is
treated as a single argument.  For example, [[ -n *.c(#qN) ]] tests whether
there are any .c files in the current directory.
</li>

<li>
In prompt strings, the %N(l.true.false) conditional (line length) and the
%N&lt;..&lt; and %N&gt;..&gt; truncation operators now accept negative values
of N, which count the remaining space to the opposite margin (positive values
of N still count the space used since the start of the prompt). In PS1 and
PROMPT, this counts to the right margin, whereas in RPS1 and RPROMPT, it
counts to the left margin (not to the opposite prompt).
</li>

<li>
Another new prompt feature is the %. escape within time strings, for example
%D{%H:%M:%S.%.}.  It provides zero-padded decimal fractions of second; by
default milliseconds are shown, but the number of digits may be indicated from
1 to 6, e.g. "%6.".  (Note this is part of the extensions to strftime()
formats rather than basic prompt escapes.)
</li>

<li>
The operators :^ and :^^ in parameter substitution allow for array zipping in
the form ${name:^array}. With the :^ operator, all entries in $name and $array
will be output in alternating order. With :^ the longer array is trimmed
whereas the :^^ operator repeats the shorter array enough to match the longer
array.
</li>
</ul>


<h2>Changes between versions 5.0.2 and 5.0.5</h2>

Releases 5.0.3 and 5.0.4 were replaced with 5.0.5 because they contained
serious bugs.

<h3>Incompatibilities</h3>

<p>
The "zshaddhistory" hook mechanism documented in the zshmisc manual page
has been upgraded so that a hook returning status 2 causes a history
line to be saved on the internal history list but not written to the
history file.  Previously any non-zero status return would cause
the line not to be saved on the history at all.  It is recommended
to use status 1 for this (indeed most shell users would naturally do
so).
</p>

<h3>Changes</h3>

<ul>
<li>
The option FORCE_FLOAT has been added to force all arithmetic constants
to be treated as floating point.  This is most useful locally within
functions or scripts performing floating point calculations.
</li>

<li>
Individual pattern characters can be disabled.  For example, to allow '^'
to be an ordinary character even if the option EXTENDED_GLOB is set, use
"disable -p '^'".
</li>

<li>
The variable editing builtin vared can be given custom editing widgets
for initialisation and finishing.
</li>

<li>
The line editor's capability for listening on file descriptors
additional to the terminal has been enhanced so that the handler for
such file descriptors can be a line editor widget.  Previously the
handler always behaved as a standard shell function.
</li>

<li>
Hooks for adding history (the function zshaddhistory and the
array zshaddhistory_functions) can return status 2 to indicate that
history is to be saved internally within the shell but not written.
</li>

<li>
The parameter HISTORY_IGNORE may be set to a pattern which matches
lines in the internal history that are to be omitted from the history
file at file write time.  This differs from history changes made in
the zshaddhistory hook or by the HIST_IGNORE_* options, all of which
take effect immediately on the internal history list itself.
</li>

<li>
The parameter ZLE_RPROMPT_INDENT can be set to 0 to remove the space
between the right hand side of the screen (this causes problems with
some terminals).  It is not special and is not set by default; the
effect in that case is as if it was 1, as in previous versions.
</li>
</ul>


<h2>Changes between versions 5.0.1 and 5.0.2</h2>

<ul>
<li>
Bug fix for anonymous functions.
</li>
</ul>


<h2>Changes between versions 5.0.0 and 5.0.1</h2>

<h3>Incompatibilities</h3>

<p>
In 5.0.0, the new "sticky" emulation feature was applied to functions
explicitly declared within an expression following `emulate ... -c', but
did not apply to functions marked for autoload in that expression.  This
was not documented and experience suggests it was inconvenient, so in
5.0.2 autoloads also have the sticky property.
</p>

<p>
In other words,
</p>

<pre>
  emulate zsh -c 'func() { ... }'
</pre>

<p>
behaves the same way in 5.0.0 and 5.0.2, with the function func always being
run in native zsh emulation regardless of the current option settings.
However,
</p>

<pre>
  emulate zsh -c 'autoload -Uz func'
</pre>

<p>
behaves differently: in 5.0.0, func was loaded with the options in
effect at the point where it was first run, and subsequently run with
whatever options were in effect at that point; in 5.0.2, func is loaded
with native zsh emulation options and run with those same options.  This
is now the recommended way of ensuring a function is loaded and run with
a consistent set of options.
</p>

<p>
Note that the command `autoload -z' has never affected the options
applied when the function is loaded or run, only the effect of the
KSH_AUTOLOAD option at the point the function is loaded.
</p>

<h3>Changes</h3>

<ul>
<li>
Numeric constants encountered in mathematical expressions (but not other
contexts) can contain underscores as separators that will be ignored on
evaluation, as allowed in other scripting languages.  For example,
0xFFFF_FFFF, or 3.141_592_654.
</li>

<li>
"functions -T" turns on tracing for the specified function(s) only,
similar to "functions -t" except that tracing is turned off for any
functions called from the specified one(s) that don't also have the -t
or -T flag.
</li>

<li>
In file completion, the recursive-files style can be set to an array of
patterns to match against "$PWD/".  In any matched location, it is
possibly to complete files in arbitrarily deep subdirectories without
needing to type the directory prefix.  See example in the zshcompsys
manual.
</li>

<li>
The _user_expand completer now allows expansion functions in the
user-expand files to return a string in REPLY that will be used to name
the set of expansions returned.
</li>
</ul>


<h2>New features between zsh versions 4.2 and 5.0</h2>

(Note: Most of these changes are already included in 4.3.17.)

<ul>
<li>
Multibyte characters strings are supported throughout the shell. Various
options, editor features, and expansion flags have been added to aid in using
them.
</li>

<li>
The following new options have appeared: COMBINING_CHARS, DEBUG_BEFORE_CMD,
HASH_EXECUTABLES_ONLY, HIST_FCNTL_LOCK, HIST_LEX_WORDS, HIST_SAVE_BY_COPY,
MULTIBYTE, NO_MULTI_FUNCDEF, PATH_SCRIPT, POSIX_ALIASES, POSIX_CD, POSIX_JOBS,
POSIX_STRINGS, POSIX_TRAPS, PROMPT_SP, SOURCE_TRACE.
</li>

<li>
Highlighting and colouring of the command line is supported.
</li>

<li>
Job control is supported in non-interactive shells and subshells.
</li>

<li>
The zshroadmap manual page provides a slightly more helpful introduction to
the shell manual than was previously available.
</li>

<li>
There have been some notable enhancements to POSIX compatibility when the
shell is in a corresponding emulation (e.g. "emulate sh").
</li>
</ul>

<h3>Expansion (parameters, globbing, etc.) and redirection</h3>

<ul>
<li>
The character group tests [[:IDENT:]], [[:IFS:]], [[:IFSSPACE:]], [[:WORD:]]
in patterns allow testing if a character can be part of an identifier, is an
IFS character, is an IFS whitespace character, or is considered part of the
word using the line editor's logic based on the shell variable WORDCHARS.
</li>

<li>
In extended globbing, "(#cN,M)" means "match the preceding group at least N
but no more than M times".
</li>

<li>
The glob qualifier P can be used with an argument to add an extra word before
each glob match.
</li>

<li>
The syntax ~[...] provides dynamic directory naming by means of the shell
function zsh_directory_name or associated hook functions. This is useful for
expanding paths with many variable components as commonly found in software
development.
</li>

<li>
Parameter substitution has the ${NAME:OFFSET} and ${NAME:OFFSET:LENGTH} syntax
for compatibility with other shells (and zero-based indexing is used to
enhance compatibility).  LENGTH may be negative to count from the end.
</li>

<li>
The arbitrary limit on parameter subscripts (262144) has been removed. As it
was not configurable and tested in an inconvenient place it was deemed
preferable to remove it completely.  The limit was originally introduced to
prevent accidental creation of a large parameter array by typos that generated
assignments along the lines of "12345678=0". The general advice is not to do
that.
</li>

<li>
The parameter substitution flag (D) abbreviates directories in parameters
using the familiar ~ form.
</li>

<li>
The parameter substitution flag (g) can take delimited arguments o, e and c to
provide echo- and print-style expansion: (g::) provides basic echo-style
expansion; (g:e:) provides the extended capabilities of print; (g:o:) provides
octal escapes without a leading zero; (g:c:) additionally expands "^c" style
control characters as for bindkey. Options may be combined, e.g. (g:eoc:).
</li>

<li>
The parameter substitution flag (m) indicates that string lengths used
calculated by the (l) and (r) flags or the # operator should take account of
the printing width of characters in multibyte mode, whether 0, 1 or more.
(mm) causes printing characters to count as 1 and non-printing characters to
count as 0.
</li>

<li>
The parameter substitution flag (q-) picks the most minimal way of quoting the
parameter words, to make the result as readable as possible.
</li>

<li>
The parameter substitution flag (Z), a variant of (z), takes arguments
describing how to split a variable using shell syntax: (Z:c:) parses comments
as strings (the default is not to treat comment characters specially); (Z:C:)
parses comments and strips them; (Z:n:) treats newlines as ordinary whitespace
(the default is to turn unquoted newlines into semicolons; this is now
documented).
</li>

<li>
The parameter subscript flag (e) forces the argument to be treated as a
string, never a pattern, e.g. ${array[(ie)*]} looks for the index of the array
element containing the literal string "*".
</li>

<li>
The operators :| and :* in parameter substitution allow for array subtraction
and intersection in the form ${name:|array}. With the :| operator, all entries
in $name that are also in $array will be removed from the substitution.
Conversely for the :* operation only the entries that are in both arrays will
be substituted.
</li>

<li>
Numeric expansions can have a positive or negative step e.g. "{3..9..2}".
Negative start and end of ranges are also now supported.
</li>

<li>
=(&lt;&lt;&lt;...) is optimised to eliminate the need for an external process.
It writes the given string to a file and substitutes the name on the command
line.
</li>

<li>
The redirection operations "{myfd}&gt;file" and "{myfd}&gt;&amp;-" open and
close a new file descriptor (at least 10) contained in the shell variable
myfd, which can be written to with "&gt;&amp;$myfd".  This allows arbitrary
file descriptors rather than the explicit range 0 to 9.
</li>

<li>
New prompt escapes:
<p>%x and %I show source file and line number, useful in $PS4 (the existing %N
and %i show names and lines in the execution environment rather than the
source file).</p>
<p>%F, %K, %f, %k allow colouring of prompts both using ANSI colour names and
values supported by individual terminal emulators.</p>
</li>
</ul>

<h3>Builtins and shell functions</h3>

<ul>
<li>
Directory-changing builtins take an option -q to suppress side effects such as
printing directories or calling the chpwd hook functions.
</li>

<li>
Various enhancements have been made to traps:
<ul>
<li>The option DEBUG_BEFORE_CMD is on by default, so DEBUG traps can be used
to debug code about to be run</li>
<li>$ZSH_DEBUG_CMD in such a trap gives the code to be run</li>
<li>"setopt ERR_EXIT" in a DEBUG trap causes the code not to be executed</li>
</ul>
</li>

<li>
The "fc" builtin is now more useful non-interactively.
</li>
</ul>

<h3>Shell variables (parameters)</h3>

<ul>
<li>
New variables:
<ul>
<li>CORRECT_IGNORE can be set to a pattern to be ignored in spelling
correction.</li>
<li>KEYBOARD_HACK defines characters to be ignored if typed unmatched at the
end of the line (an extension of the SUN_KEYBOARD_HACK option, but note that
setting the option will override the variable).</li>
<li>ZSH_PATCHLEVEL provides a unique indication of the code compiled to make
the shell, even between releases.</li>
<li>ZSH_SUBSHELL indicates the subshell level, incremented once per fork, at
which the code is being run.</li> </ul>
</li>
</ul>

<h3>Options</h3>

<ul>
<li>
New options:
<ul>
<li>COMBINING_CHARS: assume that the terminal displays combining characters
correctly.  The shell cannot determine this by itself, hence the option.  This
is highly recommended for MacOS X where file names are stored with accented
characters split into basic and combining characters.</li>
<li>DEBUG_BEFORE_CMD (on by default): execute debug traps before the code they
refer to.  This is a change of the default behaviour as the new behaviour is
much more useful.</li>
<li>HASH_EXECUTABLES_ONLY: don't insert non-executable files into the command
hash used e.g. by completion; this is optional as the resulting behaviour may
be very slow on network paths.</li>
<li>HIST_FCNTL_LOCK: Use the system's file locking mechanism instead of an
ad-hoc mechanism for locking history files.</li>
<li>HIST_LEX_WORDS: Perform lexical analysis on history lines read from files,
so the words are more accurately determined.  May be very slow.</li>
<li>HIST_SAVE_BY_COPY (on by default): if unset, write a history file in place
by truncating the old one.  Only needs to be turned off in special
circumstances.</li>
<li>MULTIBYTE (on by default if available): both variables and editor command
lines are treated as sequences of multibyte characters rather than raw bytes
depending on the locale.  May be turned off within functions to perform
bytewise operations.</li>
<li>MULTI_FUNCDEF (on by default): "foo bar () { ... }" defines two functions.
This is often found to be confusing and bug-prone, so you may want to unset
it.</li>
<li>PATH_SCRIPT: search the path for a script specified as the first argument
to the shell on invocation.</li>
<li>POSIX_ALIASES: reserved words are not candidates for alias expansion.</li>
<li>POSIX_CD: make directory changing more POSIX-compatible.</li>
<li>POSIX_JOBS: make job control more POSIX compliant.</li>
<li>POSIX_STRINGS: $'...\0...' always processes \0 as a NULL, but if the
option is set the remainder of the string is ignored.</li>
<li>POSIX_TRAPS: EXIT traps are not executed on return from shell
functions.</li>
<li>PROMPT_SP: improves display of lines not ending with newlines when
PROMPT_CR is in effect.</li>
<li>SOURCE_TRACE: print information as files are executed with ".", "source",
or as startup or shutdown files.</li>
</ul>
</li>
</ul>

<h3>Line editor</h3>

<ul>
<li>
Supports multibyte characters, including characters wider than one screen cell
and (with the COMBINING_CHARS option) combining characters.
</li>

<li>
New builtin widgets:
<ul>
<li>arguments-base: allow non-decimal numeric arguments</li>
<li>history-incremental-pattern-search-{backward,forward}: support patterns in
incremental searches.</li>
</ul>
</li>

<li>
New special variables:
<ul>
<li>region_highlight allows arbitrary highlighting of parts of the command
line; it is maintained dynamically.</li>
<li>UNDO_CHANGE_NO gives a unique record of the current change state of the
command line, for undoing back to a particular point using the undo
widget.</li>
<li>zle_highlight provides master control of highlighting for special modes,
e.g. unprintable characters.</li>
<li>ZLE_LINE_ABORTED records an editor line that was aborted by an error or
C-g.  It can be used to recover aborted lines.</li>
<li>ZLE_STATE give miscellaneous information, currently whether the line
editor is in insert or overwrite mode.</li>
</ul>
</li>

<li>
The undo widget takes an argument, a previous value of $UNDO_CHANGE_NO.
</li>
</ul>

<h3>Completion</h3>

<ul>
<li>
Many new and enhanced completion functions
</li>

<li>
New styles:
<ul>
<li>accept-exact-dirs:  suppress path expansion of directory components that
already exist, speeding up completion significantly on slow network
directories.</li>
<li>path-completion:  can be used to suppress directory components before the
current one completely, so e.g. /u/b&lt;TAB&gt; only completes after the "b",
not the "u".</li>
</ul>
</li>

<li>
New special variables:<br>
ZLE_REMOVE_SUFFIX_CHARS, ZLE_SPACE_SUFFIX_CHARS provide enhanced flexibility
over suffix removal.
</li>

<li>
Matching control, typically handled with the matcher-list style, supports
named character ranges, such as [:upper:], wherever ranges were allowed, for
example 'm:{[:upper:]}={[:lower:]}'. However, matching control does not yet
handle multibyte characters properly, so this is currently limited to ASCII.
</li>
</ul>

<h3>Syntax and compatibility</h3>

<ul>
<li>
Substitutions of the form ${var:-"$@"} and ${var:+"$@"} now behave much more
like other shells when appropriate (e.g. with the SH_WORD_SPLIT option).
</li>

<li>
Assignments within variable substitutions, such as ${var=value}, are also more
compatible with other shells where appropriate.
</li>

<li>
The emulate command can now be passed an expression to be evaluated in a
"sticky" emulation, so that functions defined there always behave in the
appropriate emulation.
</li>

<li>
"emulate sh" and similar modes have improved compatibility with respect to
deciding whether the shell should exit on errors.
</li>

<li>
Signals now accept SIG as part of the name.
</li>
</ul>

<h3>Modules</h3>

<ul>
<li>
Modules now present "features", specific builtins (b:), parameters (p:),
conditions (c:) and math functions (f:), allowing more control over what is
imported from a module.
</li>

<li>
The zsh/curses module provides access to the "curses" screen manipulation
package.
</li>

<li>
The zsh/datetime module has a calendar utility, although it is not as robust
as standalone calendar utilities.
</li>

<li>
The zsh/newuser module and associated functions has facilities for setting up
startup files for a first-time user.
</li>

<li>
The zsh/parameter module contains some new arrays to aid in tracing of the
shell's call stack: $funcsourcetrace and $funcfiletrace.
</li>

<li>
The zsh/parameter module provides $usergroups, an associative arrays whose
keys are the names of groups the current user belongs to, with the group
identifier as the corresponding value.
</li>

<li>
The zsh/system module has a zsystem builtin which provides file locking and
also a forward-compatible means for testing subcommands supported.
</li>
</ul>

<h3>Internal improvements</h3>

<ul>
<li>
High resolution timestamps are used internally for certain comparisons when
available.
</li>
</ul>

<h3>Add-on functions</h3>

<ul>
<li>
The VCS_Info system provides a way of keeping track of the state of numerous
version control systems within the shell.
</li>

<li>
cdr etc.: change to a directory from a list that persists between shell
instances, with completion support.
</li>

<li>
regexp-replace replaces text in variables using regular expressions; it may be
used by zle function widgets based on the functions replace-string and
replace-string-again to provide regular expression replacements in the line
editor.
</li>
</ul>

<hr>


<h2>Changes between versions 4.3.16 and 4.3.17</h2>

<p>
Complete fixes from last release.
</p>

<h2>Changes between versions 4.3.15 and 4.3.16</h2>

<p>
The option HASH_EXECUTABLES_ONLY has been added.  When this is set,
directories in the command path will be checked for executables before they
are added to the command table (hash); otherwise, all files in the directory
are added.  The effect of this option was present in 4.3.15, which could cause
significant delays when hashing on systems with network directories in the
path.
</p>

<p>
The shell emulation mode was improved for more bash-like behavior. The bash
completion support was also improved.
</p>

<p>
New completions for sqlite, vcsh and xclip.
<p>

<h2>Changes between versions 4.3.14 and 4.3.15</h2>

<p>
Fix a POSIX compatibility related bug which might cause a subshell to hang.
</p>

<h2>Changes between versions 4.3.13 and 4.3.14</h2>

<p>
Bug fixes in code and test suite.
</p>

<h2>Changes between versions 4.3.12 and 4.3.13</h2>

<p>
There are no significant feature changes to the shell itself, although
many bug fixes and improvements to functions.
</p>

<h2>Changes between versions 4.3.11 and 4.3.12</h2>

<p>
The zsh/parameter module has a new readonly associative array
$usergroups whose keys are the names of system groups of which the
current user is a member and whose values are the corresponding
group identifiers.
</p>

<p>
The region_highlight array, which controls highlighting of the
command line from zle widgets, is now updated dynamically as
the command line is edited.
</p>

<p>
In POSIX emulation ("emulate sh") the shell is more accurate about
when it should or should not exit on errors.
</p>

<p>
The ${NAME:OFFSET:LENGTH} syntax now supports negative LENGTH, which
counts back from the end of the string.
</p>

<p>
The (g:opts:) flag in parameter expansion processes escape sequences like
the echo and print builtins.  opts can be any combination of o, e and c.
With e, acts like print rather than echo except for octal escapes which
are controlled separately by the o option.  With c, interpret control
sequences like "^X" as bindkey does.  Regardless of the opts, \c is not
interpreted.
</p>

<h2>Changes between versions 4.3.10 and 4.3.11</h2>

<p>
Note also the list of incompatibilities in the README file.
</p>

<p>
When the shell is invoked with the base name of a script, for example as
`zsh scriptname', previous versions of zsh have used the name directly,
whereas other shells use the value of $PATH to find the script.  The
option PATH_SCRIPT has been added to provide the alternative behaviour.
This is turned on where appropriate in compatibility modes.
</p>

<h3>Parameters, globbing, etc.</h3>

<p>
Parameter expansion has been enhanced to provide the ${NAME:OFFSET} and
${NAME:OFFSET:LENGTH} syntax for substrings and subarrays present in
several other shells.  OFFSET always uses zero-based indexing.  The only
clash with existing zsh syntax occurs if OFFSET begins with an
alphabetic character or `&amp;', which is not likely.
</p>

<p>
The (D) flag in parameter expansion abbreviates directories in the
substituted value.  The (q-) flag does minimal shell quotation of arguments
for maximum human readability of the result.
</p>

<p>
The (Z) flag in parameter expansion is an enhanced version of the (z)
flag that takes an argument indicating how the string to be split
is treated. (Z:c:) parses comments as strings; (Z:C:) parses comments
and strips them; (Z:n:) treats newlines as ordinary whitespace: (z)
has always treated unquoted newlines as shell delimiters and turned them
into semicolons, though this was not previously documented.
</p>

<p>
Numeric expansion with braces has been extended so that a step may be
given, as in {3..9..2}.  The step may be negative as may the start and
end of the range (this is also new).
</p>

<p>
The glob qualifier P can be used to add a separate word before each
match.  For example, *(P:-f:) produces the command line
`-f file1 -f file2 ...'.
</p>

<p>
Regular expression matches now use the same variables for storing matched
components as shell pattern matching.  The function system now provides the
function regexp-replace for replacing text using regular expressions.  The
zle widget functions replace-string, replace-string-again, if defined with
regex in the name (e.g. "zle -N replace-regexp replace-string"), perform
regular expression matches.  In replacement text \&amp; and \1 have the
standard meaning.
</p>

<h3>Line editor and completion</h3>

<p>
The completion system now has a style path-completion.  Setting this to
false inhibits completion of paths before the current path component,
e.g. /u/b/z no longer completes to /usr/bin/zsh.  This is useful on systems
where this form of completion is pathologically slow due to network
performance.
</p>

<p>
With the MULTIBYTE option, the line editor now highlights bytes in the
input that are not part of a valid character in the current locale in hex
as &lt;XX&gt; for hex digits X; highlighting is controlled by the "special"
keyword in the zle_highlight array.  These can be distinguished from
unprintable Unicode characters which also use "special" highlighting as the
latter are always two or four bytes long, e.g. &lt;XXXX&gt;, &lt;XXXXXXXX&gt;.
</p>

<p>
zle_highlight also controls highlighting of a removable completion
suffix, e.g. the "/" automatically appended to directories.  This uses
the keyword "suffix".
</p>

<p>
The line editor now sets the variable ZLE_LINE_ABORTED if there is
an error when editing the line.  The following code can be used
to create a bindable editor widget to restore the aborted line:
  recover-line() { LBUFFER=$ZLE_LINE_ABORTED RBUFFER=; }
  zle -N recover-line
and then either bind recover-line to a key sequence or use
`M-x recover-line &lt;RET&gt;'.
</p>

<p>
The parameter ZLE_STATE, available in user-defined line editor widgets,
gives information on the state of the line editor.  Currently this is
whether the line editor is in insert or overwrite mode.
</p>

<h3>Miscellaneous options</h3>

<p>
The new shell option HIST_LEX_WORDS causes history lines read in from
a file to be split in the same way as normal shell lines, instead of
simply on whitespace.  It's an option as although the result is more
accurate it can take a long time when the history size is large.
</p>

<p>
The shell option MONITOR can be set in non-interactive shells, and also in
subshells (as created by surrounding commands with parentheses), turning on
job control for that subshell.  The initial behaviour of a subshell is
still to turn job control off, however if the new POSIX_JOBS option is set
MONITOR remains active in subshells.
</p>

<p>
The new shell option POSIX_CD, active in emulations of POSIX-based shells,
makes the cd builtin POSIX-compatible.
</p>

<p>
The POSIX_JOBS option already referred to has various other
compatibility enchancements.
</p>

<p>
The new shell option POSIX_STRINGS makes a null character in $'...'
expansion terminate the string, as is already the case in bash.  This is
not particularly useful behaviour but may become a POSIX requirement.
</p>

<p>
The new shell option POSIX_TRAPS causes the EXIT trap to behave in the same
way as in other shells, i.e. it is only run when the shell exits.
</p>

<p>
The new shell option SOURCE_TRACE causes the shell to report files
containing shell code that the shell executes directly, i.e. startup files
or files run with the `source' or `.' builtins.
</p>

<p>
The shell option SUN_KEYBOARD_HACK has been supplemented by a more general
mechanism: the KEYBOARD_HACK variable defines the character to be ignored.
</p>

<h3>Add-on modules and function</h3>

<p>
The module zsh/system has a new "zsystem" builtin whose subcommands perform
system level tasks.  Currently "zsystem flock" performs advisory file
locking (for aficionados, this uses the fcntl() system call so works over
the network on Linux).  This is a particularly convenient way of locking
files for the length of a subshell.  "zsystem supports flock" provides a
test for this feature.
</p>

<p>
There is now a function system for recording and restoring recently
entered directories in a persistent fashion, with support in completion
and (if explicitly installed) dynamic directory expansion.  See the
entry for cdr in the zshcontrib manual page.
</p>

<h2>Changes between versions 4.3.9 and 4.3.10</h2>

<p>
The command "<tt>emulate &lt;mode&gt; -c ...</tt>" evaluates an expression in a given
emulation.  The emulation is sticky for functions defined within the
expression.
</p><p>
The variable <tt>CORRECT_IGNORE</tt> gives a pattern that can be ignored
in spelling correction.  <tt>CORRECT_IGNORE='_*'</tt> ignores completion functions.
</p><p>
The option <tt>POSIX_ALIASES</tt> improves compatibility of aliases with other
shells.
</p><p>
The variable <tt>ZSH_PATCHLEVEL</tt> can be used to test for unreleased versions of
the shell; it is present but less useful in released versions.
</p><p>
The variables <tt>ZLE_REMOVE_SUFFIX_CHARS</tt> and <tt>ZLE_SPACE_SUFFIX_CHARS</tt> allow more
control over the way automatically removed suffixes are treated in
completion.
</p>

<h2>Major changes between versions 4.3.6 and 4.3.9</h2>

<p>
The option <tt>COMBINING_CHARS</tt> has been added.  When it is set, the
line editor assumes the terminal is capable of displaying zero-width
combining characters (typically accents) correctly as modifications
to the base character, and will act accordingly.  Note it is not set
by default owing to vagaries of terminals.  The system is reported
to work on MacOS, where this is particularly important as accented
characters in file names are stored in their decomposed form (i.e.
with base and combining characters).
</p><p>
The option <tt>HIST_FCNTL_LOCK</tt> has been added to provide locking of history
files using the system call <tt>fcntl()</tt>.  On recent NFS implementations this
may provide better reliability.
</p><p>
The syntax <tt>~[...]</tt> provides a dynamic form of directory naming,
supplementing the existing static ~name syntax.  A user-defined shell
function, zsh_directory_name, is used to handle both expansion of names to
directories and contraction of directories to names.
</p><p>
Patterns can now be used in incremental searches with the new widgets
<tt>history-incremental-pattern-search-backward</tt> and
<tt>history-incremental-pattern-search-forward</tt>.  These are not bound to
keys by default.
</p><p>
Highlighting and colouring of sections of the command line is now
supported, controlled by the array parameter zle_highlight and the ZLE
special parameter region_highlight.
</p><p>
Colouring of prompts is now supported within the shell by prompt
escapes.  The prompt theme system has been updated.
</p>

Various changes have been added to make debugging of shell code easier:
<ul>
<li>As noted in README, the option <tt>DEBUG_BEFORE_CMD</tt> is now set by default.
</li>
<li>In <tt>DEBUG</tt> traps, <tt>$ZSH_DEBUG_CMD</tt> gives the code for which the trap is
    called as a string.
</li>
<li><tt>"setopt ERR_EXIT"</tt> in a <tt>DEBUG</tt> trap causes the code not to be executed.
</li>
<li><tt>$ZSH_SUBSHELL</tt> indicates the subshell level at which code is being
    executed.
</li>
<li>The zsh/parameter module has various additional arrays similar to
    the existing <tt>$funcstack</tt> and <tt>$functrace</tt>, namely <tt>$funcsourcetrace</tt>
    and <tt>$funcfiletrace</tt>.  The consistency and informativeness of
    the output of all these arrays has been improved.
</li>
<li>Prompt escapes <tt>%x</tt> and <tt>%I</tt> show the source file and line number in
    debug prompts (compare <tt>%N</tt> and <tt>%i</tt> which show names and line numbers
    in the execution environment).
</li>
<li>The option <tt>NO_MULTI_FUNCDEF</tt> can turn off multiple definition of
    functions at once, a rarely used feature that can cause problems
    with misplaced "<tt>()</tt>".
</li>
<li>The "<tt>fc</tt>" builtin has been enhanced to make non-interactive use possible
    and output consistent when the history is manipulated with "<tt>print -s</tt>".
</li>
</ul>

<p>
The completion style accept-exact-dirs has been added.  When true, this
suppresses attempts to complete non-final directory segments of a filename
path when the directory exists.  (For example, <tt>/home/pws/src/zsh/&lt;TAB&gt;</tt>
discovers that <tt>/home/pws/src/zsh</tt> exists and leaves the directory component
alone, while <tt>/h/p/s/z/&lt;TAB&gt;</tt> completes to <tt>/home/pws/src/zsh/...</tt> as before.)
This should improve completion behaviour noticeably in special cases, such
as remote paths under Cygwin.
</p>

<h2>Major changes between versions 4.3.5 and 4.3.6</h2>

<p>
<tt>cd</tt>, <tt>chdir</tt>, <tt>pushd</tt> and <tt>popd</tt> now take a <tt>-q</tt> option to suppress side effects
including printing the directory stack (for <tt>pushd</tt> and <tt>popd</tt>) and executing
the <tt>chpwd</tt> hook functions (for all four).
</p><p>
The parameter subscript (<tt>e</tt>) flag now forces the argument to be treated
as a string where it would previously have been treated as a pattern,
for example <tt>${array[(ie)*]}</tt> substitutes the index of the element whose
value is "<tt>*</tt>".
</p>

<h2>Major changes between versions 4.3.4 and 4.3.5</h2>

<ul>
<li>The new extended globbing flag (<tt>#cN,M</tt>) behaves similarly to the extended
  regular expression syntax <tt>{N,M}</tt>.
</li>
<li>The zsh/datetime module has been enhanced and a calendar function
  system has been added along the lines of (but much enhanced from)
  the traditional Unix "calendar" utility.  This is still under
  development.  See the zshcalsys manual.  (The calendar functions
  were in 4.3.4 but were not listed in this file.  There have been
  significant enhancements since 4.3.4.)
</li>
<li>A new module zsh/curses provides a builtin zcurses for access to
  to the curses screen manipulation package.  See the entry for zsh/curses
  in the zshmodules manual.
</li>
<li>The module system has been enhanced to support the notion of "features"
  that give more control over which builtins, parameters, conditions
  and math functions are loaded from a module.  In particular,
  "<tt>zmodload -F zsh/stat b:zstat</tt>" makes the builtin previously called
  "stat" available as "zstat" (only) to avoid clashes with a system
  command named "stat".
</li>
</ul>

<h2>Major changes between versions 4.2 and 4.3.4</h2>

<ul>
<li>There is support for multibyte character sets.  This is now reasonably
  close to complete, although Unicode combining characters don't work
  properly.  See Multibyte Character Support in INSTALL.
</li>
<li>The shell can now run an installation function for a new user
  (a user with no .zshrc, .zshenv, .zprofile or .zlogin file) without
  any additional setting up by the administrator.  See "THE ZSH/NEWUSER
  MODULE" in the zshmodules manual page.
</li>
<li>The manual now has a Roadmap section (manual page zshroadmap) to
  give new users an indication of the most interesting parts of the
  manual.
</li>
<li>New option <tt>PROMPT_SP</tt> (on by default): works around the problem that the
  line editor can overwrite output with no newline at the end.  See the
  zshoptions manual page.
</li>
<li>New option <tt>HIST_SAVE_BY_COPY</tt> (on by default): history is saved by
  copying and renaming instead of directly overwriting.  See the
  zshoptions manual page.
</li>
<li>New redirection syntax e.g. <tt>{myfd}&gt;file</tt> opens a new file descriptor
  and stores the number in <tt>$myfd</tt>, so that <tt>&gt;&amp;$myfd</tt> will work.  Chosen
  not to break existing code (and to be compatible with proposals for the
  Korn shell).  See the section REDIRECTION in the zshmisc manual page.
</li>
<li>Substitutions of the form <tt>${var:-"$@"}</tt>, <tt>${var:+"$@"}</tt> and similar where
  word-splitting is applied to the text after the :- or :+ (in particular,
  where the <tt>SH_WORD_SPLIT</tt> option is in effect for compatibility) now
  behave as in other Bourne- and POSIX-compatible shells when in the
  appropriate emulation mode.
</li>
<li>New Posix-style zsh-specific tests <tt>[[:IDENT:]]</tt>, <tt>[[:IFS:]]</tt>,
  <tt>[[:IFSSPACE:]]</tt>, <tt>[[:WORD:]]</tt> test if character can appear in identifier,
  is an IFS character, is an IFS whitespace character, or is considered
  as part of a word (is alphanumeric or appears in <tt>$WORDCHARS</tt>).  These
  works correctly on multibyte characters if the appropriate support
  is present.  See the section FILENAME GENERATION in the zshexpn
  manual page.
</li>
<li>Time comparisons on files when sorting or using test operators will
  use high-resolution timestamps when available.  This gives a
  resolution of a nanosecond instead of a second.
</li>
<li>The idiom <tt>=(&lt;&lt;&lt;...)</tt> is optimised so that the shell internally turns
  the ... into the contents of a file whose name is then substituted.
  The syntax has always been usable by means of the <tt>NULLCMD</tt> feature,
  but previously it generated an intermediate process; it has now
  been rewritten along the same lines as the optimisation for <tt>$(&lt;...)</tt>
  that inserts a file into the command line without the use of an
  external programme.
</li>
<li>Supplied functions catch and throw provide limited support for
exception handling using the <tt>`{ ... }</tt> always <tt>{ ... }'</tt> syntax.
  See the section EXCEPTION HANDLING in the zshcontrib manual page.
</li>
<li>Signals now accept the SIG as part of the name for compatibility with
  other shells.
</li>
<li>Editor function argument-base allows non-decimal arguments for
  editor widgets.  See the entry in the zshzle manual page.
</li>
<li>As always, there are many enhancements to completion functions.
</li>
</ul>

<h2>Changes since zsh version 4.2.0</h2>

<ul>
<li>The autoload and related builtins take options -k and -z to indicate
ksh or zsh autoloading style for given functions, making it possible
to mix and match.</li>

<li>Assignments to associative arrays can use the i and r index flags.
For example,
<pre>assoc[(i)alpha*]=bravo</pre>
sets the value for the element whose key matches the pattern `alpha*';
<pre>assoc[(r)activ*]=passive</pre>
sets the value for the element whose current value matches the pattern
`activ*'.
</li>

<li>The glob qualifier F indicates a non-empty directory.  Hence <tt>*(F)</tt>
indicates all subdirectories with entries, <tt>*(/^F)</tt> means all
subdirectories with no entries.</li>

<li>fc -p and fc -P provide push/pop for the status of the shell's
history (both internal and using the history file).  With automatic
scoping (fc -ap) it becomes easy to use a temporary history in a
function.  This has been added to the calculator function zcalc to make
its internal history work more seamlessly.</li>

<li>A new <i>try block</i> and <i>always block</i> syntax has been introduced
to make it easier to ensure the shell runs important tidy-up code
in the event of an error.  It also runs after a break, continue, or
return, including a return forced by the ERR_RETURN option
(but not an exit, which is immediate).  The syntax is:
<pre>`{'  try-block-list `}' `always' `{' always-block-list `}'</pre>
where no newline or semicolon may appear between `}' and `always'.
This is compatible with all previous valid zsh syntax as an `always'
at that point used to be a syntax error.  For example,
<pre>{ echo Code run in current shell } always { echo Tidy-up code }</pre></li>

<li>A new zle widget reset-prompt has been added to re-expand the
current prompt.  Changes to the variable in use as well as changes in its
expanions are both taken into account.  The same effect is now forced
by a job change notification, making the <tt>%j</tt> prompt escape and
<tt>%(j..)</tt> ternary expression more useful.</li>

<li>The zftp module supports ports following the hostname in the normal suffix
notation, `host:port'.  This requires IPv6 colon-style addresses to be
specified in suitably quoted square brackets, for example:
<pre>
zftp open '[f000::baaa]'
zftp open '[f000::baaa]:ftp'
</pre>
(the two are equivalent).</li>

<li>Special traps, those that don't correspond to signals, i.e. ZERR, DEBUG
and EXIT are no longer executed inside other traps.  This caused
unnecessary confusion if, for example, both DEBUG and EXIT traps
were set.  The new behaviour is more compatible with other shells.</li>

<li>New option TRAPS_ASYNC which if set allows traps to run while the
shell is waiting for a child process.  This is the traditional zsh
behaviour; POSIX requires the option to be unset.  In sh/ksh
compatibility mode the option is turned off by default and the option
letter -T turns it on, for compatibility with FreeBSD sh.</li>

<li>New WIDGETSTYLE, WIDGETFUNC parameters in ZLE.</li>

<li>Glob qualifiers <tt>(+func)</tt> is shorthand for <tt>(e:func:)</tt>
(calls command, typically shell function, with no argument).</li>
</ul>

<hr>


<h2>New features between zsh versions 4.0 and 4.2</h2>

Configuration:
<ul>
  <li>upgraded to use autoconf post-2.50
  <li>improved compatibility with other shells through shell options,
  builtin arguments and improved builtin option parsing
</ul>

Syntax and builtins:
<ul>
  <li>new printf builtin
  <li>`+=' to append to parameters which works for scalars, arrays and (with
  pairs) associative arrays.
  <li>enhanced multiple parameter `for' loops:
    for key value in key1 value1 key2 value2 ...
  maintaining full compatibility with POSIX syntax.
  <li>Suffix aliases allow the shell to run a command on a file by suffix,
  e.g `<tt>alias -s ps=gv</tt>' makes `<tt>foo.ps</tt>' execute `<tt>gv foo.ps</tt>'.  Supplied
  function zsh-mime-setup uses existing mailcap and mime.types files
  to set up suitable aliases.  Supplied function pick-web-browser is
  suitable for finding a browser to show .html etc. files by suffix alias.
  <li>new option `no_case_glob' for case-insensitive globbing.
</ul>

Add-on modules and functions:
<ul>
  <li>zsh/datetime modules makes date formatting and seconds since EPOCH
  available inside the shell.
  <li>zsh/net/tcp module provides builtin interface to TCP through ztcp
  builtin.  Function suite for interactive and script use with expect-style
  pattern matching.
  <li>zsh/net/socket module provides zsocket builtin.
  <li>zcalc calculator function with full line editing.
  <li>builtin interface to pcre library
  <li>zsh/zselect module provides zselect builtin as interface to select
  system call
</ul>

Completion system:
<ul>
  <li>general improvements to command and context support, low-level functions,
  display code.
  <li>in verbose mode, matches with the same description are grouped
  <li>highly configurable completions for values of specific parameters,
  specific redirections for specific commands
  <li>support for bash completion functions (typically zsh native functions are
  more powerful where available)
  <li>New completions provided for (some of these may be in later 4.0
  releases):  valgrind, tidy, texinfo, infocmp, Java classes, larch, limit,
  locale parameters, netcat, mysqldiff, mt, lsof, elinks, ant, debchange
  (dch), email addresses, file system types, Perforce, xsltproc.
  Plus many others.
</ul>

Line editor:
<ul>
  <li>special parameters $PREDISPLAY, $POSTDISPLAY available in function
  widgets to configure uneditable text (for narrowing)
  <li>recursive editing
  <li>supplied widgets read-from-minibuffer, replace-string use these features
  (more intuitive prompting and argument reading than 4.0)
  <li>access to killed text via $CUTBUFFER and $killring
  <li>supplied highly configurable word widgets forward-word-match etc., can
  set what constitutes a word interactively or in startup script
  (implement bash-style behaviour, replacing previous bash-* word widgets)
  <li>interface to incremental search via $LASTSEARCH
  <li>better handling of keymaps in zle and widgets
  <li>better support for output from user-defined widgets while zle is active
  <li>tetris game which runs entirely in zle
  <li>several other contributed widgets
</ul>

Local internal improvements:
<ul>
  <li>disowned jobs are automatically restarted
  <li>\u and \U print escapes for Unicode
  <li>read -d &lt;delimiter&gt; allows a custom line ending.
  <li>read -t &lt;timeout&gt;.
  <li>line numbers in error messages and $PS4 output are more consistent
  <li>`=prog' expands only paths, no longer aliases for consistency
  <li>job display in prompts; `jobs' command output can be piped
  <li>prompts: new $RPROMPT2, %^, %j, %y, enhanced %{, %}, %_.
  <li>rand48() function in zsh/mathfunc for better randomness in arithmetic
  (if the corresponding math library function is present)
  <li>$SECONDS parameter can be made floating point via `typeset -F SECONDS'
  for better timing accuracy
  <li>improvements to command line history mechanism
  <li>job table is dynamically sized, preventing overflow (typically seen
  previously in complex completions).
  <li>many bugfixes
</ul>

<hr>


<h2>New features in zsh version 4.0.1</h2>

Compared with 3.1.9, there are mostly incremental improvements to
<ul>
  <li>the new completion system &mdash; more functions, completers, styles...
  <li>the line editor
  <li>handling of signals and traps
  <li>the configuration system, particularly for modules
  <li>Cygwin support (now essentially complete)
  <li>arithmetic evaluation
  <li>the zpty (pseudoterminal handling) module
  <li>the test suite
</ul>
plus various bug fixes and compatibility improvements.

<p>The alias modules (zle.so as an alias for zsh/zle.so, etc.) have been
removed; use `zmodload -A' to load modules under other names.  This is
irrelevant if you are upgrading from 3.0.

<p>Compared with the 3.0 series of releases (the last stable set), the most
significant of a large number of improvements in the shell are:
<ul>
  <li>Dynamically loadable modules with hierarchical naming system
  <li>Shell functions as editor functions, with much additional builtin support
  <li>Incredibly rich new completion system; just needs a single
    initialization command to provide completion for all sorts of commands
    and contexts
  <li>Associative arrays
  <li>Lots of new features in parameter substitution and globbing; more
    logical handling of nested parameter substitutions
  <li>Rewritten pattern-matching (globbing) code supports approximate
    and case-insensitive matching and backreferences
  <li>Various custom modules for pty's, FTP, special parameters, etc.
  <li>Rewrites of many internal parts of the code: execution code to
    provide compilation to internal representation, pattern matching
  <li>Floating point arithmetic and mathematical functions module
  <li>A test suite
  <li>Various new options for compatibility with this, that and the other
</ul>
See the 3.1.x changes below for more detail.

<hr>


<h2>New features in zsh version 3.1.8 and 3.1.9</h2>
<p>These are primarily bug-fix versions.  There are only a few user-visible
changes.
<ul><li>Array slices ${array[a,b]} with b &lt; a now correctly have zero length.</li></ul>

<h2>New features in zsh version 3.1.7</h2>

<p>Further enhancements to new completion system:
<ul>
 <li>Comprehensive context-sensitive configuration via `styles', which
   can be set by the menu-driven front end in compinstall
 <li>General mechanism for setting patterns to be ignored in a completion;
   overriding  of patterns to be matched for functions
 <li>New completers: _prefix to complete word before cursor, _ignored
   to complete using words so far ignored (like $fignore but more
   powerful), _history to complete words from shell history
 <li>Multiple use of completers with different options, similarly splitting
   of different types of completion (`tags') so they are considered with
   different styles
 <li>Many more supplied completions for standard commands which work out of
   the box, and better handling of command line options/arguments which
   behave in the usual way   
 <li>$fpath now set up to use installed functions by default; functions
   can be loaded just by `autoload -U compinit; compinit'
 <li>Much improved handling of nested quoting and nested braces
 <li>New LIST_PACKED and LIST_ROWS_FIRST completion options and corresponding
   styles
 <li>compctl library separated out (frozen but still supported)
 <li>User-friendly introduction <a href="Guide/">available</a> at zsh website
</ul>

<p>Additions to complist listing library (coloured completion and menu
selection):
<ul>
 <li>Listings can be shown page by page (are by default for new completion)
 <li>Menu selection allows full up and down scrolling of long lists
</ul>

<p>Other editing features:
<ul>
 <li>new parameters $PENDING, $MARK, $BUFFERLINES
 <li>Easy display of a prompt from within an editing widget
</ul>

<p>Code parsing, storing and execution:
<ul>
 <li>Completely new system of storing code internally, greatly optimised
 <li>Much less memory for shell functions etc.
 <li>Can compile shell functions to .zwc `wordcode' functions for fast
   loading
 <li>Can create `digest' files of entire directories in .zwc format
</ul>

<p>Parameters:
<ul>
 <li>Floating point support added, similar to ksh93, `typeset -F' and
   `typeset -E' declare floating point variables; usual C/Fortran-like
   rules for integer/float conversion
 <li>Mathematical library zsh/mathfunc contains all the standard mathematical
   functions for use in arithmetical expressions
 <li>Improved parsing of arithmetical expressions and better error messages
 <li>Special parameters can be made local
 <li>`typeset -h' hides specialness of parameters, either as parameter
   attribute or when declaring new local variable
 <li>Local parameters can now be exported as in other shells; new option
   GLOBAL_EXPORTS on by default provides old behaviour that `typeset -x'
   referred to global parameters.
 <li>zsh/parameter module enhanced: now needed for new completion; parameters
   provided have `-h' flag set so that they are hidden by `typeset', so
   that existing functions don't need to be changed
 <li>Quotes can be stripped from parameter values with ${(Q)...}, providing
   reverse of ${(q...)...} facility
</ul>

<p>Globbing and pattern matching:
<ul>
 <li>Pattern matching rewritten for efficiency
 <li>Supports `backreferences', i.e. extracting parenthesised chunks of
   matches, e.g.
     [[ $foo = (#b)(*/)[^/]* ]]
   stores the part of $foo up to the last / in $match[1] and the indexes of
   the match in $mbegin[1], $mend[1].  (#m) is also available to set $MATCH
   to the entire match and corresponding $MBEGIN, $MEND:  useful in
   parameter substitutions like ${.../.../...}.
 <li>(#s) and (#e) match start and end of pattern like ^ and $ in regular
   expression, useful in complex expressions such as ((#s)|/)dirname((#e)|/)
   and in parameter expressions.

 <li>Depth-first/last listing of recursive glob lists
</ul>

<p>Functions etc.:
<ul>
 <li>`autoload -X' inside a function body instructs the shell to
   bootstrap the function at that point
 <li>`autoload +X fn' says load the function fn but don't execute it
 <li>Prompt `themes' make customization of prompts easier
</ul>

<p>Modules:
<ul>
 <li>New hierarchical naming scheme for modules; supplied modules go into
   zsh subdirectory, so zle becomes zsh/zle etc.; aliases supplied for
   compatibility for existing code, but the new format should be used in
   future.
 <li>zmodload is more consistent between dynamically and statically linked
   shells
 <li>zsh/zftp and its function suite support multiple sessions (zfsession
   command); zftransfer allows transfer of files between two ftp sessions
   with no local file; use styles for e.g. progress style; IPv6 supported;
   recursive put `zfput -r' for uploads
 <li>zsh/zpty module creates pseudoterminal and allows builtin `expect'-like
   behaviour
</ul>

<p>Other:
<ul>
 <li>Test suite, not yet complete (`make test')
 <li>use of Linux task limits
 <li>Many fixes including output redirection with `setopt xtrace' and
   other redirection fixes; NIS+ problem.
 <li>Better null-command behaviour in sh and csh emulation
 <li>Internal memory usage optimisations
</ul>

<h2>New features in zsh version 3.1.6 (beta version)</h2>

<p>Note also the changes for 3.0.6, which include changes between 3.1.5. and
3.1.6.

<p>New completion system via shell functions; massive degree of
programmability and configurability:
<ul>
 <li>ready-made function suite to use, see zshcompsys(1)
 <li>approximate completion and spelling correction via completion
 <li>control over matching for case-independence, partial word completion, etc.
 <li>menu selection:  choose a completion by moving the cursor
 <li>coloured completion lists
 <li>completion of filenames in quotes is now more reliable; splitting
   quoted strings into command arguments is also possible.
</ul>

<p>Other editing changes:
<ul>
  <li>enhancements to function/editing interface:  new parameters, numeric
    arguments, string argument passing, reading keys from widgets.
  <li>the old history-search-{back,for}ward behaviour and bindings have
    returned (up to minor details).
  <li>BASH_AUTO_LIST option to show completion list only on second key press.
  <li>the ZBEEP parameter gives a string to output instead of beeping,
    allowing you to have a visual bell.
</ul>

<p>History changes: new options HIST_NO_FUNCTIONS, HIST_EXPIRE_DUPS_FIRST,
HIST_FIND_NO_DUPS, HIST_IGNORE_ALL_DUPS, INC_APPEND_HISTORY,
HIST_SAVE_NO_DUPS, SHARE_HISTORY, allow better control of when history is
read and written and how duplicates are handled.  New format for history
saves.

<p>Associative arrays plus enhanced parameter substitutions to retrieve keys
and values.

<p>Globbing changes:
<ul>
  <li>Case-insensitive and approximate globbing.
  <li>Ordering and indexing of globbing matches, e.g. *(om[1]) picks
    most recently modified file.
  <li>General file mode qualifier with chmod(1)-like syntax, e.g. *(f:u+wx:)
</ul>

<p>New loadable modules:
<ul>
  <li>zftp, plus associated function suite, for turning your zsh session
    into an FTP session too
  <li>parameter, for examining and altering shell hash tables via an
    associative array interface.
  <li>mapfile, for reading and writing external files via an associative
    array interface.
</ul>

<p>Debugging and prompt enhancements:
<ul>
  <li>$PS4 can contain %i for $LINENO as well as %N for script or function
    names (default PS4 changed), also %_ for current shell structure
    executing;
  <li>Prompt truncation %&lt;...&lt; is now more flexible: it applies to a
    whole section of the prompt, not just one escape.  You need to put
    %&lt;&lt; after the truncated escape to get the old behaviour.
  <li>%20(l.yes.no) in prompts prints yes if at least 20 characters have
    been output, else no (e.g. for outputting extra newlines).
</ul>

<p>Parameter and expansion changes
<ul>
  <li>`typeset -t MYPATH mypath' creates tied path/PATH-like variables
  <li>`typeset -g' allows operations on parameters without making them local
  <li>New expansions
    <ul>
    <li>${(t)param} prints type information for $param
    <li>${(P)param} treats value of $param as the name of a param to
      substitute
    <li>${foo:q} can quote replaced parameter text from expansion
    <li>${foo/old/new} substitution, like bash; also (S) flag for shortest
      match
    <li>$foo[(b.2.i)bar] starts searching $foo for bar starting at 2nd match
  </ul>
</ul>

<p>Builtin and function changes
<ul>
  <li>stat module: `stat -H hash foo' gives you e.g. $hash[mtime]
  <li>`autoload -U' autoloads functions without alias expansion.
</ul>

<p>Other new options:
<ul>
  <li>LOCAL_TRAPS allows signal traps to be local to functions (as in ksh).
  <li>NO_RCS can now be turned on at any point in initialization files.
  <li>NO_GLOBAL_RCS can force /etc/z* files after /etc/zshenv to be skipped.
    (Please don't use this as an excuse to stuff more into /etc/zshenv!)
  <li>Existing MAGIC_EQUAL_SUBST option is more useful; any argument containing
    ...=~...:~... will perform filename expansion on the ~ (previously,
    the string before `=' had to look like a parameter name).
</ul>

<p>Configuration changes:
<ul>
  <li>Generation of signal names should be more reliable
  <li>Customizable installation of shell functions from distribution.
</ul>

<hr>


<h2>New features in zsh version 3.0.6</h2>

<p>Most of these changes are designed to improve compatibility with zsh
version 3.1.6, the latest development release.  However, this release also
fixes all known Year 2000 (Y2K) bugs in zsh 3.0.

<p>History changes:
<ul>
  <li>whitespace between words is ignored in history searches.
  <li>new option HIST_REDUCE_BLANKS removes extra whitespace in the stored
    history.
  <li>support for reading (but not writing) version 3.1.6 history files.
</ul>

<p>Globbing changes:
<ul>
  <li>the a, c, and m glob qualifiers can now test time in seconds.
  <li>globbing of number ranges behaves more like character ranges in that
    it can match a prefix of a number, e.g. `&lt;1-5&gt;*' matches 1, 2, 3, 4,
    5, 17, 23skiddoo, 5986, etc., but not 6, 7, 8ball, 911, etc.
</ul>

<p>Parameter and expansion changes:
<ul>
  <li>expansion of ~ and other globbing flags via ${~param} do not depend
    upon EXTENDED_GLOB (bug fix).
  <li>nested parameter substitutions require braces (this was always the
    documented behavior, but previous parsers didn't enforce it).
  <li>quote only nested expansion, e.g. ${(f)"$(&lt;file)"} reads complete
    `file', then splits lines into array.
</ul>

<p>Builtin and function changes:
<ul>
  <li>`typeset -U' works on the colon-array version of linked parameters.
  <li>`typeset +f' and `functions +' output the names (only) of functions.
  <li>`emulate -L' has the effect of `setopt localoptions'.
  <li>in fn1() { local foo; unset foo; foo=bar; }, foo is restored at local
    level, whereas if the `unset foo' appeared in a nested function it
    would have been restored at global level, which was presumably wrong.
  <li>`foo=bar &gt;&amp;file' is a redirection, not a NULLCMD.
  <li>any single complex command, such as `case ... esac', parses as if
    semicolon-terminated (bug fix).
  <li>the shell function `preexec', if defined, is run after parsing each
    command line but before executing the command.
</ul>

<p>Other changes:
<ul>
  <li>the option PRINT_EIGHT_BIT causes zsh to emit raw bytes in prompts
    and completion lists even if the system ctype(3) package says that
    those bytes are not "printable."
</ul>

<p>Debugging enhancements:
<ul>
  <li>LINENO is now very much more useful in scripts and functions and is
    reported correctly in most error messages.
  <li>ERREXIT behavior is now consistent with newer Bourne-like shells,
    e.g. with respect to `if' tests that fail.
</ul>

<p>Configuration changes:
<ul>
  <li>Large file and 64-bit integers on 32-bit machines supported where
    provided by OS.
  <li>a few more system features, such as getpwnam/getpwuid, are tested for.
</ul>

<h2>New features in zsh version 3.1 (beta version)</h2>

<p>On most operating systems zsh can load binary modules dynamically at
run-time. ZLE and the compctl builtin are now reside in a separate
module which is loaded automatically on demand.

<p>for ((expr; expr; expr)) do ... done loop syntax from AT&amp;T ksh93 is
now supported.

<p>POSIX globbing character classes ([:alnum:] etc.) are now supported.

<p>ksh's case fall-through feature (;&amp;) is supported.

<p>ksh93's $'' quoting syntax is supported.

<p>Restricted mode is now supported.  This is controlled by the new option
RESTRICTED (-r).

<p>New options BARE_GLOB_QUAL, HIST_NO_FUNCTIONS (alias NO_LOG), KSH_GLOB,
PRINT_EIGHT_BIT, PROMPT_BANG, PROMPT_PERCENT, RM_STAR_WAIT.

<p>Options ALWAYS_LAST_PROMPT, APPEND_HISTORY, AUTO_LIST, AUTO_MENU,
AUTO_PARAM_KEYS, AUTO_PARAM_SLASH, AUTO_REMOVE_SLASH, LIST_AMBIGUOUS
and LIST_TYPES are now on by default.

<p>In ZLE, arbitrarily many keymaps can be defined.  Multi-character
keybindings now work.

<p>Completion can be performed within a brace expansion.

<p>EMACS-like universal-argument function.


<h2>New features in zsh version 3.0</h2>

<p>Trailing "/" in a glob pattern now works like in other shell thus it
can no longer be used as a shorthand for "(/)".

<p>Much improved sh/ksh emulation.  When zsh is invoked as sh it mostly
conforms to POSIX 1003.2.

<p>Enhanced parameter expansion features: new flags: A, @, e, W, p, f, F.
Expansions can be nested.  For example,
"${${(M)${(f@)$(&lt;builtin.pro)}:#char*}[2][(w)3]}" expands to the third
word of the second line of builtin.pro which begins with char.  See
zshexpn(1) for the details.

<p>***/foo glob does recursive directory search following symbolic links.

<p>Traps defined by the trap builtin are now executed in the current shell
environment and not as a shell function.  This means that $1 is not set
to the signal number.  Of course the TRAPxxx functions continue working
as before.

<p>Traps defined by the trap builtin are reset to their default values in
subshells.

<p>Option names can be prefixed by `no' to unset an option.
setopt no_option_name is the same as unsetopt option_name.
This change affects the output of the setopt and unsetopt
builtins when these are invoked without arguments.  See
the zshoptions manual page for more explanation.

<p>!, {, } and [[ are now reserved words.  Things like [[-z $foo]] or {foo}
should not be used.  {foo} still works if the IGNORE_BRACES option is not
set but this feature may be removed in the future.  [[ -z $foo ]] and
{ foo } should be used instead.

<p>HOSTTYPE special parameter is removed.  The new OSTYPE, MACHTYPE and
VENDOR parameters should be used instead.

<p>VERSION parameter is renamed to ZSH_VERSION

<p>exec now saves the history in interactive shells.  If you do not like this
behaviour you can alias exec to 'unset HISTFILE ; exec'.

<p>${~spec}, ${=spec} and ${^spec} used to toggle the effect of
globsubst/shwordsplit/rcexpandparam.  Now these force the corresponding
option on. ~, = or ^ can be doubled to force the relevant option off for
the substitution.

<p>Explicitly requested word splitting like ${=spec} or ${(s:delim:)spec}
will be executed even if the substitution is double quoted.

<p>The right-hand side of assignments are no longer globbed by default hence
assignment foo=* will assign '*' as a value of foo.  Use the foo=( * )
array assignment syntax to get the old behaviour.  Alternatively the
GLOB_ASSIGN can be set to emulate the old behaviour but the usage of this
option is strongly discouraged and this option may be completely removed in
the future.

<p>foo=$bar no longer creates an array even if bar is an array.  Use
foo=( $bar ) or even better, foo=( "$bar[@]" ) instead.

<p>When foo is an array parameter ${#foo} will always return the length of the
array even if the substitution is double quoted.  ${(c)#foo} should be used
to get back the old behaviour.

<p>When the prompt_subst option is set prompts are fully expanded using
parameter expansion, command substitution and arithmetic expansion.
In 2.5 backquote substitution was not performed in the prompts so this
change might cause problems in some startup scripts if ` is used literally
in prompts.

<p>History substitution is now not performed if the history escape character
appears in a single-quoted string.  This may break some interactive shell
functions which use \! in single-quoted strings.

<p>The UID, EUID, GID, EGID parameters can be assigned now. The assignment
executes the setuid(), seteuid(), setgid(), setegid() respectively.  On
systems where setuid and seteuid is not supported these functions are
emulated using setreuid or setresuid which may result in a different
behaviour.

<p>Assigning the USERNAME parameter will call setuid(uid) where uid is the
user id of the specified user.

<p>The privileged (-p) option is automatically set on invocation if euid != uid
or egid != gid.  If this option is set no user startup files are sourced.
The shell will drop privileges when this option is unset by resetting its
euid to uid and its egid to gid.

<p>The =number substitution for accessing the directory stack is changed to
~number to allow =command substitution when a command name begins with a 
digit.

<p>&lt;&gt; is a redirection operator which opens the standard input for both
reading and writing.  To match a number use &lt;-&gt;

<p>Option letters -1 and -C for PRINT_EXIT_VALUE and NO_CLOBBER are swapped:
`set -C' sets NO_CLOBBER and `set -1' sets PRINT_EXIT_VALUE.

<p>AUTO_PUSHD behaviour is changed.  Now cd without arguments will always go
to the $HOME directory even if AUTO_PUSHD is set and PUSHD_TO_HOME is not
set.  If you preferred the old behaviour you can alias cd to pushd.

<p>IFS word splitting with SH_WORD_SPLIT and the splitting of the input in
the read builtin has changed in cases when IFS contains characters other
than &lt;space&gt;, &lt;tab&gt;, &lt;newline&gt;. See the description of IFS
in the zshparam manual page for more details.

<h2>New features in zsh version 2.5</h2>

<p>Greatly expanded completion possibilities.  Programmable completion
allows detailed control over what arguments of what commands can be
completed to what.  See dots/zcomp in the distribution for examples.

<p>Expand filenames with ~ and = on the right hand side of parameter
assignments.  New option MAGIC_EQUAL_SUBST to do it in all
identifier=expression arguments.

<p>${+name} becomes 1 or 0 if name is set or unset.  ${~spec} toggles
GLOB_SUBST in substitution.  Parameter substitution takes lots
of flags in the format ${(flags)name}.

<p>New glob qualifiers for block/character special files, times in glob
qualifiers can be in months, weeks, days, hours, minutes.  Qualifiers can
work on links or on what they point to.  Qualifiers separated by commas
are or-ed.

<p>New parameter substitution modifiers (fFwW) to repeat actions.  New
option CSH_JUNKIE_HISTORY.

<p>New line editor functions history-beginning-search-backward,
history-beginning-search-forward, expand-or-complete-prefix, push-input,
push-line-or-edit.

<p>Assign to part of a string, use qualifiers on string subscription with
$foo[(qual)2,5]

<p>New parameters: EGID, EUID, KEYTIMEOUT

<p>New prompt escape sequence %_ to get constructs like for and while in
the secondary prompt.  %E in prompt clears to end of screen.

<p>Conditional expressions in PROMPT and WATCHFMT.

<p>New options ALWAYS_LAST_PROMPT, ALWAYS_TO_END, AUTO_PARAM_KEYS,
COMPLETE_ALIASES, COMPLETE_IN_WORD, CSH_JUNKIE_HISTORY, GLOB_SUBST,
LIST_AMBIGUOUS, MAGIC_EQUAL_SUBST, NO_FLOW_CONTROL, PROMPT_SUBST

<p>New option -m to many builtins makes arguments subject to pattern
matching.

<p>Bindkey can now bind both key sequences and prefixes of those.  You can
for example bind ESC and function keys sending ESC sequences.

<p>Additional options to read builtin to use in functions called by
completion.

<p>New options to print to sort arguments and print them in columns.

<p>Some additional resource limits can be specified.

<p>Some editor functions now work in the minibuffer.

<hr>
<div align=right>
<address>
<a name=Signature href="disclaimer.html">Disclaimer</A>
Last modified: 2017-01-03
</address>
</div>

</body>
</html>
